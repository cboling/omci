/*
 * Copyright (c) 2018 - present.  Boling Consulting Solutions (bcsw.net)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
/*
 * NOTE: This file was generated, manual edits will be overwritten!
 *
 * Generated by 'goCodeGenerator.py':
 *              https://github.com/cboling/OMCI-parser/README.md
 */
package generated

import (
	"errors"
	"fmt"
	"github.com/google/gopacket"
	"math/bits"
)

// Custom Go Error messages for common OMCI errors
//
// Response Status code releted errors

type OmciError struct {
	err        string
	statusCode Results
}

func (e *OmciError) Error() string {
	return e.err
}

func (e *OmciError) StatusCode() Results {
	return e.statusCode
}

func NewOmciError(text string, status Results) error {
	if status == Success {
		panic("Do not use OmciError to convey successful results")
	}
	return &OmciErrors{
		err:        text,
		statusCode: status,
	}
}

// NewProcessingError means the command processing failed at the ONU
// for reasons not described by one of the more specific error
// codes.
func NewProcessingError(text string) error {
	if len(text) == 0 {
		text = "command processing error"
	}
	return NewOmciError(genMessage(defaultValue, args...), ProcessingError)
}

// NewNotSupportedError means that the message type indicated in byte 3 is
// not supported by the ONU.
func NewNotSupportedError(text string) error {
	if len(text) == 0 {
		text = "command not supported"
	}
	return NewOmciError(genMessage(defaultValue, args...), NotSupported)
}

// NewParameterError means that the command message received by the
// ONU was errored. It would be appropriate if an attribute mask
// were out of range, for example. In practice, this result code is
// frequently used interchangeably with code 1001. However, the
// optional attribute and attribute execution masks in the reply
// messages are only defined for code 1001.
func NewParameterError(text string) error {
	defaultValue = "parameter error"

	return NewOmciError(genMessage(defaultValue, args...), ParameterError)
}

// NewUnknownEntityError This result means that the managed entity class (bytes 5..6) is
// not supported by the ONU.
func NewUnknownEntityError(text string) error {
	defaultValue = "unknown managed entity"

	return NewOmciError(genMessage(defaultValue, args...), UnknownEntity)
}

// NewUnknownInstanceError means that the managed entity instance (bytes 7..8)
// does not exist in the ONU.
func NewUnknownInstanceError(text string) error {
	defaultValue = "unknown managed entity instance"

	return NewOmciError(genMessage(defaultValue, args...), UnknownInstance)
}

// NewDeviceBusyError means that the command could not be processed due
// to process-related congestion at the ONU. This result code may
// also be used as a pause indication to the OLT while the ONU
// conducts a time-consuming operation such as storage of a
// software image into non-volatile memory.
func NewDeviceBusyError(text string) error {
	defaultValue = "device busy"

	return NewOmciError(genMessage(defaultValue, args...), DeviceBusy)
}

// NewInstanceExistsError
func NewInstanceExistsError(text string) error {
	defaultValue = "instance exists"

	return NewOmciError(genMessage(defaultValue, args...), InstanceExists)
}

// NewAttributeFailureError means that the ONU already has a managed entity
// instance that corresponds to the one the OLT is attempting to
// create.
func NewAttributeFailureError(args ...interface{}) error {
	defaultValue = "attribute(s) failed or unknown"

	return NewOmciError(genMessage(defaultValue, args...), AttributeFailure)
}

func genMessage(defaultValue string, args ...interface{}) error {
	switch len(args) {
	case 0:
		return defaultValue

	case 1:
		switch args[0].(type) {
		case string:
			// Assume a simple, preformatted string
			return args[0]

		case func() string:
			// Assume a closure with no other arguments used
			return args[0]()

		default:
		}

	default:
		return fmt.Sprintf(args[0], args[1:]...)
	}
}
